<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html><html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><title>lib/presentations/qp/Website-Meta-Lecture/src/examples/faq-l/api.wml</title><meta charset="utf-8"/><style>body{color:#000;background:#fff none}A:link{color:#00f;background:#fff none}A:visited{color:#909;background:#fff none}A:hover{color:red;background:#fff none}A:active{color:red;background:#fff none}.synComment{color:#00f}.synConstant{color:#f0f}.synIdentifier{color:#008b8b}.synStatement{color:brown;font-weight:700}.synPreProc{color:#a020f0}.synType{color:#2e8b57;font-weight:700}.synSpecial{color:#6a5acd}.synUnderlined{color:#000;text-decoration:underline}.synError{color:#fff;background:red none}.synTodo{color:#00f;background:#ff0 none}</style></head><body><pre>&lt;:{
<span class="synStatement">use vars</span> <span class="synConstant">qw(@question_number)</span>;

<span class="synIdentifier">@question_number</span>=(<span class="synConstant">0</span>);
}:&gt;

;;; Perl code here:
<span class="synIdentifier">&lt;</span><span class="synStatement">define-tag</span><span class="synIdentifier"> next-question&gt;</span>&lt;:{
    <span class="synStatement">my</span> <span class="synIdentifier">$temp</span> = <span class="synStatement">pop</span>(<span class="synIdentifier">@question_number</span>)+<span class="synConstant">1</span>;
    <span class="synStatement">push</span> <span class="synIdentifier">@question_number</span>, <span class="synIdentifier">$temp</span>;
    <span class="synStatement">my</span> <span class="synIdentifier">$qn_text</span> = <span class="synStatement">join</span>(<span class="synConstant">&quot;.&quot;</span>, <span class="synIdentifier">@question_number</span>);
    <span class="synStatement">print</span> <span class="synIdentifier">$qn_text</span>;
}:&gt;<span class="synIdentifier">&lt;/</span><span class="synStatement">define-tag</span><span class="synIdentifier">&gt;</span>

;;; Perl code here:
<span class="synIdentifier">&lt;</span><span class="synStatement">define-tag</span><span class="synIdentifier"> promote&gt;</span>&lt;:{
    <span class="synStatement">push</span> <span class="synIdentifier">@question_number</span>, <span class="synConstant">0</span>;
}:&gt;<span class="synIdentifier">&lt;/</span><span class="synStatement">define-tag</span><span class="synIdentifier">&gt;</span>

;;; Perl code here:
<span class="synIdentifier">&lt;</span><span class="synStatement">define-tag</span><span class="synIdentifier"> demote&gt;</span>&lt;:{
    <span class="synStatement">pop</span>(<span class="synIdentifier">@question_number</span>);
}:&gt;<span class="synIdentifier">&lt;/</span><span class="synStatement">define-tag</span><span class="synIdentifier">&gt;</span>



<span class="synIdentifier">&lt;</span><span class="synStatement">define-tag</span><span class="synIdentifier"> question endtag=</span><span class="synConstant">&quot;required&quot;</span><span class="synIdentifier">&gt;</span>
;;; Define anchor to be the first argument
<span class="synIdentifier">&lt;</span>preserve<span class="synIdentifier"> anchor /&gt;</span>
;;; Define title to be the second argument
<span class="synIdentifier">&lt;</span>preserve<span class="synIdentifier"> </span><span class="synType">title</span><span class="synIdentifier"> /&gt;</span>

;;; This statement is required to actually set
;;; anchor and title to a proper value
<span class="synIdentifier">&lt;</span>set-<span class="synStatement">var</span><span class="synIdentifier"> %attributes /&gt;</span>

;;; next-question is defined above
<span class="synIdentifier">&lt;</span>set-<span class="synStatement">var</span><span class="synIdentifier"> question-number=</span><span class="synConstant">&quot;&lt;next-question /&gt;&quot;</span><span class="synIdentifier"> /&gt;</span>

<span class="synIdentifier">&lt;</span>if<span class="synIdentifier"> </span><span class="synError">&lt;</span><span class="synIdentifier">get-var render-body /&gt;</span>
;;; If the question should be rendered.
        &quot;
        <span class="synIdentifier">&lt;</span><span class="synStatement">p</span><span class="synIdentifier"> </span><span class="synType">id</span><span class="synIdentifier">=</span><span class="synConstant">&quot;&lt;get-var anchor /&gt;&quot;</span><span class="synIdentifier">&gt;&lt;</span><span class="synStatement">b</span><span class="synIdentifier">&gt;&lt;</span>get-<span class="synStatement">var</span><span class="synIdentifier"> question-number /&gt;</span>. <span class="synIdentifier">&lt;</span>get-<span class="synStatement">var</span><span class="synIdentifier"> </span><span class="synType">title</span><span class="synIdentifier"> /&gt;&lt;/</span><span class="synStatement">b</span><span class="synIdentifier">&gt;&lt;/</span><span class="synStatement">p</span><span class="synIdentifier">&gt;</span>
        %body
        &quot;
;;; If not
    &quot;<span class="synIdentifier">&lt;</span><span class="synStatement">a</span><span class="synIdentifier"> </span><span class="synType">href</span><span class="synIdentifier">=</span><span class="synConstant">&quot;answers.html#&lt;get-var anchor /&gt;&quot;</span><span class="synIdentifier">&gt;&lt;</span>get-<span class="synStatement">var</span><span class="synIdentifier"> question-number /&gt;</span>. <span class="synIdentifier">&lt;</span>get-<span class="synStatement">var</span><span class="synIdentifier"> </span><span class="synType">title</span><span class="synIdentifier"> /&gt;&lt;/</span><span class="synStatement">a</span><span class="synIdentifier">&gt;&lt;</span><span class="synStatement">br</span><span class="synIdentifier"> /&gt;</span>&quot;
    /<span class="synError">&gt;</span>
;;; Restore their previous values
<span class="synIdentifier">&lt;</span><span class="synStatement">restore</span><span class="synIdentifier"> </span><span class="synType">title</span><span class="synIdentifier"> /&gt;</span>
<span class="synIdentifier">&lt;</span><span class="synStatement">restore</span><span class="synIdentifier"> anchor /&gt;</span>
<span class="synIdentifier">&lt;/</span><span class="synStatement">define-tag</span><span class="synIdentifier">&gt;</span>
</pre></body></html>