!function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof module&&"object"==typeof module.exports?module.exports=factory:factory(jQuery)}(function($){$.expander={version:"2.0.1",defaults:{slicePoint:100,sliceOn:null,preserveWords:!0,normalizeWhitespace:!0,showWordCount:!1,detailPrefix:" ",wordCountText:" ({{count}} words)",widow:4,expandText:"read more",expandPrefix:"&hellip; ",expandAfterSummary:!1,wordEnd:/(&(?:[^;]+;)?|[0-9a-zA-Z\u00C0-\u0100]+|[^\u0000-\u007F]+)$/,summaryClass:"summary",detailClass:"details",moreClass:"read-more",lessClass:"read-less",moreLinkClass:"more-link",lessLinkClass:"less-link",collapseTimer:0,expandEffect:"slideDown",expandSpeed:250,collapseEffect:"slideUp",collapseSpeed:200,userCollapse:!0,userCollapseText:"read less",userCollapsePrefix:" ",onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null,afterCollapse:null}},$.fn.expander=function(options){var delayedCollapse,meth="init",opts=("string"==typeof options&&(meth=options,options={}),$.extend({},$.expander.defaults,options)),rSelfClose=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i,rAmpWordEnd=opts.wordEnd,rOpenCloseTag=/<\/?(\w+)[^>]*>/g,rOpenTag=/<(\w+)[^>]*>/g,rCloseTag=/<\/(\w+)>/g,rLastCloseTag=/(<\/([^>]+)>)\s*$/,rTagPlus=/^(<[^>]+>)+.?/,rMultiSpace=/\s\s+/g,options={init:function(){this.each(function(){var i,l,tmp,newChar,summTagless,summCloses,lastCloseTag,detailText,$thisDetails,$readMore,str,openTagsForDetails=[],closeTagsForsummaryText=[],defined={},thisEl=this,$this=$(this),$summEl=$([]),o=$.extend({},opts,$this.data("expander")||{}),hasDetails=!!$this.find("."+o.detailClass).length,hasBlocks=!!$this.find("*").filter(function(){var display=$(this).css("display");return/^block|table|list/.test(display)}).length,detailSelector=(hasBlocks?"div":"span")+"."+o.detailClass,moreClass=o.moreClass+"",lessClass=o.lessClass+"",expandSpeed=o.expandSpeed||0,allHtml=(str=$this.html(),opts.normalizeWhitespace?$.trim(str||"").replace(rMultiSpace," "):str),summaryText=allHtml.slice(0,o.slicePoint);if(o.moreSelector="span."+moreClass.split(" ").join("."),o.lessSelector="span."+lessClass.split(" ").join("."),!$.data(this,"expanderInit")){for($.data(this,"expanderInit",!0),$.data(this,"expander",o),$.each(["onSlice","beforeExpand","afterExpand","onCollapse","afterCollapse"],function(index,val){defined[val]=$.isFunction(o[val])}),summTagless=(summaryText=backup(summaryText)).replace(rOpenCloseTag,"").length;summTagless<o.slicePoint;)summaryText+=newChar="<"===(newChar=allHtml.charAt(summaryText.length))?allHtml.slice(summaryText.length).match(rTagPlus)[0]:newChar,summTagless++;for(str=(summaryText=backup(summaryText=o.sliceOn?function(info){var summaryTextClean=info.summaryText.replace(info.sliceOn,"ExpandMoreHere374216623"),summaryTextClean=(summaryTextClean=$("<div>"+summaryTextClean+"</div>").text()).indexOf("ExpandMoreHere374216623"),sliceOnIndexHtml=info.summaryText.indexOf(info.sliceOn);-1!==summaryTextClean&&summaryTextClean<info.slicePoint&&(info.summaryText=info.allHtml.slice(0,sliceOnIndexHtml));return info}({sliceOn:o.sliceOn,slicePoint:o.slicePoint,allHtml:allHtml,summaryText:summaryText}).summaryText:summaryText,o.preserveWords&&allHtml.slice(summaryText.length).length)).match(rOpenTag)||[],summCloses=summaryText.match(rCloseTag)||[],tmp=[],$.each(str,function(index,val){rSelfClose.test(val)||tmp.push(val)}),str=tmp,l=summCloses.length,i=0;i<l;i++)summCloses[i]=summCloses[i].replace(rCloseTag,"$1");if($.each(str,function(index,val){var thisTagName=val.replace(rOpenTag,"$1"),closePosition=$.inArray(thisTagName,summCloses);-1===closePosition?(openTagsForDetails.push(val),closeTagsForsummaryText.push("</"+thisTagName+">")):summCloses.splice(closePosition,1)}),closeTagsForsummaryText.reverse(),hasDetails)detailText=$this.find(detailSelector).remove().html(),allHtml=(summaryText=$this.html())+detailText,lastCloseTag="";else{if(detailText=allHtml.slice(summaryText.length),""===(moreClass=$.trim(detailText.replace(rOpenCloseTag,"")))||moreClass.split(/\s+/).length<o.widow)return;lastCloseTag=closeTagsForsummaryText.pop()||"",summaryText+=closeTagsForsummaryText.join(""),detailText=openTagsForDetails.join("")+detailText}o.moreLabel=$this.find(o.moreSelector).length?"":function(o,detailText){var ret='<span class="'+o.moreClass+'">'+o.expandPrefix;o.showWordCount?o.wordCountText=o.wordCountText.replace(/\{\{count\}\}/,detailText.replace(rOpenCloseTag,"").replace(/&(?:amp|nbsp);/g,"").replace(/(?:^\s+|\s+$)/,"").match(/\w+/g).length):o.wordCountText="";return ret+='<a href="#" class="'+o.moreLinkClass+'">'+o.expandText+o.wordCountText+"</a></span>"}(o,detailText),hasBlocks?detailText=allHtml:"&"===summaryText.charAt(summaryText.length-1)&&(lessClass=/^[#\w\d\\]+;/.exec(detailText))&&(detailText=detailText.slice(lessClass[0].length),summaryText+=lessClass[0]),o.summary=summaryText+=lastCloseTag,o.details=detailText,o.lastCloseTag=lastCloseTag,str=function(o,blocks){var el="span",summary=o.summary,closingTagParts=rLastCloseTag.exec(summary),closingTag=closingTagParts?closingTagParts[2].toLowerCase():"";blocks?(el="div",closingTagParts&&"a"!==closingTag&&!o.expandAfterSummary?summary=summary.replace(rLastCloseTag,o.moreLabel+"$1"):summary+=o.moreLabel,summary='<div class="'+o.summaryClass+'">'+summary+"</div>"):summary+=o.moreLabel;return[summary,o.detailPrefix||"","<",el+' class="'+o.detailClass+'"',">",o.details,"</"+el+">"].join("")}(o=defined.onSlice?(tmp=o.onSlice.call(thisEl,o))&&tmp.details?tmp:o:o,hasBlocks),$this.empty().append(str),$thisDetails=$this.find(detailSelector),$readMore=$this.find(o.moreSelector),"slideUp"===o.collapseEffect&&"slideDown"!==o.expandEffect||$this.is(":hidden")?$thisDetails.css({display:"none"}):$thisDetails[o.collapseEffect](0),$summEl=$this.find("div."+o.summaryClass),hasDetails=function(event){event.preventDefault();event=event.startExpanded?0:expandSpeed;$readMore.hide(),$summEl.hide(),defined.beforeExpand&&o.beforeExpand.call(thisEl),$thisDetails.stop(!1,!0)[o.expandEffect](event,function(){$thisDetails.css({zoom:""}),defined.afterExpand&&o.afterExpand.call(thisEl),function(option,$collapseEl,thisEl){option.collapseTimer&&(delayedCollapse=setTimeout(function(){reCollapse(option,$collapseEl),$.isFunction(option.onCollapse)&&option.onCollapse.call(thisEl,!1)},option.collapseTimer))}(o,$thisDetails,thisEl)})},$readMore.find("a").off("click.expander").on("click.expander",hasDetails),o.userCollapse&&!$this.find(o.lessSelector).length&&$this.find(detailSelector).append('<span class="'+o.lessClass+'">'+o.userCollapsePrefix+'<a href="#" class="'+o.lessLinkClass+'">'+o.userCollapseText+"</a></span>"),$this.find(o.lessSelector+" a").off("click.expander").on("click.expander",function(event){event.preventDefault(),clearTimeout(delayedCollapse);event=$(this).closest(detailSelector);reCollapse(o,event),defined.onCollapse&&o.onCollapse.call(thisEl,!0)}),o.startExpanded&&hasDetails({preventDefault:function(){},startExpanded:!0})}})},destroy:function(){this.each(function(){var o,details,$this=$(this);$this.data("expanderInit")&&(o=$.extend({},$this.data("expander")||{},opts),details=$this.find("."+o.detailClass).contents(),$this.removeData("expanderInit"),$this.removeData("expander"),$this.find(o.moreSelector).remove(),$this.find("."+o.summaryClass).remove(),$this.find("."+o.detailClass).after(details).remove(),$this.find(o.lessSelector).remove())})}};function backup(txt,preserveWords){return txt.lastIndexOf("<")>txt.lastIndexOf(">")&&(txt=txt.slice(0,txt.lastIndexOf("<"))),preserveWords&&(txt=txt.replace(rAmpWordEnd,"")),$.trim(txt)}function reCollapse(o,el){el.stop(!0,!0)[o.collapseEffect](o.collapseSpeed,function(){el.prev("span."+o.moreClass).show().length||el.parent().children("div."+o.summaryClass).show().find("span."+o.moreClass).show(),o.afterCollapse&&o.afterCollapse.call(el)})}return options[meth]&&options[meth].call(this),this},$.fn.expander.defaults=$.expander.defaults});